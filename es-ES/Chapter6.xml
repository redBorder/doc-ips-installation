<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "manual.ent">
<!ENTITY PRODUCT "Documentation">
<!ENTITY BOOKID "manual">
<!ENTITY YEAR "2016">
<!ENTITY HOLDER "Eneo Tecnología S.L. |">
]>
<chapter>
	<title>Configuración de los sensores IPS/IDS</title>
	<para>Existen tres modos de acceder a la edición de los sensores IPS/IDS para la configuración de sus parámetros de funcionamiento:</para>
	<itemizedlist mark="bullet">
		<listitem>
			<para><emphasis role="bold">Vista árbol</emphasis>: en la vista árbol el usuario puede ver los sensores IPS/IDS que se han creado acompañados de un icono identificativo. Para acceder a su edición hacer clic sobre el nombre del sensor o bien, en el icono de opciones y después en <literal>Edit</literal>.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch06_img001.png"/>
				</imageobject>
				<caption>
					<para>Vista árbol: editar sensor IPS/IDS</para>
				</caption>
			</mediaobject>
		</listitem>
		<listitem>
			<para><emphasis role="bold">Vista Access Points</emphasis>: la vista de Access Points muestra un listado con los puntos de acceso a la red que se han definido. Haciendo clic sobre un Access Point se accede a la interfaz de configuración de los parámetros generales del sensor.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="150" fileref="images/ch06_img002.png"/>
				</imageobject>
				<caption>
					<para>Vista Access Points: editar sensor IPS/IDS</para>
				</caption>
			</mediaobject>
		</listitem>
		<listitem>
			<para><emphasis role="bold">Vista específica de IPS</emphasis>: en la opción <literal>View</literal> se encuentran vistas específicas para cada tipo de sensor. Seleccionar <literal>IPS sensors</literal> para acceder al listado alfabético de los sensores IPS. Hacer clic en el icono de edición.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch06_img003.png"/>
				</imageobject>
				<caption>
					<para>Vista IPS Sensors: IPS/IDS</para>
				</caption>
			</mediaobject>
		</listitem>
	</itemizedlist>
	<section>
	<title>Editar la configuración del sensor IPS/IDS</title>
		<para>En todos los casos descritos el usuario accede a una pantalla en la que puede realizar la configuración de los parámetros básicos de los sensores IPS/IDS.</para>
		<para>Los campos del formulario de configuración varían según se esté editando un sensor, grupo de segmentos o binding.	Este paso es muy importante puesto que una configuración u otra determinará el modo de funcionamiento del sensor<phrase condition="malware"> según se instale en un escenario u otro (IPS o Malware)</phrase>. Estas opciones se definen en el apartado <emphasis role="bold">Configuración IPS/IDS</emphasis>.</para>
		<para>A continuación se enumeran los campos que se muestran en el formulario de configuración de un sensor IPS:</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para>General: muestra información general del sensor. La única información editable en este apartado es la descripción.<footnote><para>Tanto la IP como el nombre del sensor han sido definidos durante el proceso de instalación y registro de los sensores en el Manager.</para></footnote></para>
			</listitem>
			<listitem>
				<para>Configuración IPS/IDS (IPS/IDS Settings)</para>
			</listitem>
			<listitem>
				<para>Servidores (Servers)</para>
			</listitem>
			<listitem>
				<para>Trap servers</para>
			</listitem>
			<listitem>
				<para>Segmentos (Segments)</para>
			</listitem>
			<listitem>
				<para>Network routes</para>
			</listitem>
			<listitem>
				<para>Localización (Location)</para>
			</listitem>
			<listitem>
				<para>IP Variables</para>
			</listitem>
			<listitem>
				<para>Variables de puertos (Port variables)</para>
			</listitem>
			<listitem>
				<para>Grupos (Groups)</para>
			</listitem>
		</itemizedlist>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch06_img004.png"/>
			</imageobject>
			<caption>
				<para>Información editable para la configuración de los sensores IPS/IDS</para>
			</caption>
		</mediaobject>
		<para>En el margen superior derecho de la pantalla encontramos las siguientes opciones:</para> 
		<itemizedlist mark="bullet">
			<listitem>
				<para><literal>Stop Auto-apply</literal></para>
				<para>Este botón evita que se apliquen de manera automática los cambios cada 5 minutos.</para>
				<para>El sistema abrirá una ventana de confirmación para asegurarse de que esta es la acción que desea realizar el usuario.</para>
			</listitem>
			<listitem>
				<para><literal>Options->Recreate Private Key</literal></para>
				<para>Esta opción regenera la clave privada de sincronización del sensor IPS con el Manager. Si tiene rol de Administrador en redBorder, encontrará también esta opción en la interfaz de edición de usuarios en <literal>Tools->Users</literal>.</para>
				<para>Una vez que se haya confirmado dicha restauración, el usuario deberá introducir el texto que se le muestra en la ventana modal en el IPS siguiendo la siguiente ruta: <literal>/etc/chef/client.pem</literal></para>
			</listitem>
		</itemizedlist>
		<warning>
			<title>Advertencia</title>
			<para><emphasis role="bold">La acción de restauración de la clave privada es muy sensible puesto que puede dejar sin comunicación al sensor con el Manager.</emphasis> Por ello, el sistema abre una ventana de confirmación antes de realizar cualquier acción. Asegúrese que está seguro de que desea realizar la restauración de la clave de seguridad antes de proceder a su confirmación.</para>
		</warning>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="150" fileref="images/ch06_img005.png"/>
			</imageobject>
			<caption>
				<para>Opciones del submenú de sensores IPS/IDS: Stop Auto-apply y Recreate Private Key</para>
			</caption>
		</mediaobject>
	</section>	
	<section>
		<title>Configuración IPS/IDS</title>
		<para>En este apartado encontramos las opciones disponibles para configurar los sensores IPS/IDS y sus modos de funcionamiento.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch06_img006.png"/>
			</imageobject>
			<caption>
				<para>Campos editables para la configuración IPS/IDS (IPS/IDS Settings)</para>
			</caption>
		</mediaobject>
		<para><literal>Sensor mode</literal></para>
		<para>Selección del modo de funcionamiento del sensor redBorder IPS:</para>
		<orderedlist>
			<listitem>
				<para><emphasis role="bold">Inherited</emphasis>: al seleccionar esta opción se le indica al sensor que herede el modo de funcionamiento del nivel superior. Entre paréntesis aparece el modo de funcionamiento heredado.</para>
			</listitem>
			<listitem>
				<para><emphasis role="bold">IDS forwarding</emphasis>: el tráfico es desviado de manera inmediata por el sensor; a continuación, una copia del mismo es analizada. En la práctica, produce el mismo efecto que tener un TAP interpuesto antes del sensor.</para>
			</listitem>
			<listitem>
				<para><emphasis role="bold">IDS span</emphasis>: únicamente se analiza el tráfico. No se realiza ningún desvío del mismo.</para>
			</listitem>
			<listitem>
				<para><emphasis role="bold">IPS test mode</emphasis>: el tráfico es analizado y, posteriormente, desviado. Este modo es el recomendado para realizar simulaciones de bloqueo de tráfico atacante.</para>
			</listitem>
			<listitem>
				<para><emphasis role="bold">IPS</emphasis>: esta es la opción más común en entornos de producción. El sensor analiza el tráfico y deja pasar o bloquea el tráfico dependiendo de las acciones establecidas para las reglas incluidas en la política activa del sensor.</para>
			</listitem>			
		</orderedlist>
		<para>A continuación, el usuario puede editar una serie de parámetros relacionados con el comportamiento de PF_RING<footnote><para>Módulo de captura de paquetes a alta velocidad.</para></footnote> y Snort<footnote><para>IPS de código abierto utilizado como núcleo de redBorder IPS.</para></footnote>:</para>
		<para><literal>PF_RING Watermark</literal></para>
		<para>Indica el número mínimo de paquetes entrantes para la función poll.</para>
		<itemizedlist mark="bullet">	
			<listitem>		
				<para>Valor bajo de <emphasis>watermark</emphasis> (1): reduce la latencia de la función poll, disminuye el throughput, pero puede incrementar el número de llamadas a la función poll.</para>
			</listitem>
			<listitem>	
				<para>Valor alto de <emphasis>watermark</emphasis> (nunca debe exceder del 50% del tamaño del anillo o de lo contrario el módulo kernel de PF_RING aumentará este valor): reduce el número de llamadas poll, pero aumenta ligeramente la latencia de paquete.</para>
			</listitem>
		</itemizedlist>
		<para><literal>PF_RING Clustermode</literal></para>
		<para>Divide el tráfico entrante en varios anillos. Especialmente indicado para <emphasis role="bold">distribuir la carga</emphasis> al posibilitar que una misma interfaz sea leída desde varios programas de Snort.</para>
		<para>Indica el número de parámetros usados para determinar el hash y el balanceo del tráfico entre los diferentes procesos Snort. 
		Dependiendo del número elementos que se agregan a la tupla el tráfico se distribuirá de una forma distinta:</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para>2 tuple flow: IP de origen+IP de destino</para>
			</listitem>
			<listitem>
				<para>4 tuple flow: IP de origen:Puerto_src+IP de destino:Puerto_dst</para>
			</listitem>
			<listitem>
				<para>5 tuple flow: IP de origen:Puerto_src+IP de destino:Puerto_dst+protocolo</para>
			</listitem>
			<listitem>
				<para>6 tuple flow: IP de origen:Puerto_src+IP de destino:Puerto_dst+protocolo+Vlan</para>
			</listitem>
		</itemizedlist>
		<para><literal>Bypass controlled by Snort</literal></para>
		<para>Cuando la máquina arranca Snort puede tomar el control de los bypass automáticamente.
		 Esta acción puede provocar un flapping indeseado del firewall para evitar que Snort esté habilitado para el control de los bypass.</para>
		<para><literal>Threshold Count</literal></para>
		<para>Número máximo de ocurrencias en un rango de tiempo determinado para que un evento sea enviado.</para>
		<para><literal>Threshold Seconds</literal></para>
		<para>Tiempo mínimo (en segundos) que tiene que pasar para que un evento sea enviado.</para>
		<note>
			<title>Nota</title>
			<para>En escenarios donde existe una sobrecarga en el tráfico es posible realizar una configuración que permita mantener la conectividad por encima del análisis de los paquetes.</para>
			<para>Las opciones de <literal>Best effort Configuration</literal> y <literal>Software Bypass Configuration</literal> se utilizan para priorizar el reenvío de información sobre el análisis de la misma.</para>
		</note>
		<para><literal>Best effort Configuration</literal></para>
		<para>Esta configuración solo aplica en el modo <emphasis role="bold">IDS</emphasis>.</para>
		<para>Al habilitar esta opción, el tráfico es copiado en una cola interna de trabajo y, posteriormente, desviado. Solo en el caso de que no existan más paquetes que desviar, se procesarán los paquetes que se encuentran en la cola interna. 
		Si la cola interna se encontrase llena, los paquetes no serán analizados. Esto aumenta la fiabilidad del desvío, pero disminuye el rendimiento del análisis. </para>
		<para><literal>Software Bypass Configuration</literal></para>
		<para>Esta configuración solo aplica en el modo <emphasis role="bold">IPS</emphasis>.</para>
		<para>La activación de esta opción implica que, si la ocupación del anillo de la interfaz es alta, el IPS desviará los paquetes sin analizar hasta que la ocupación se encuentre por debajo de otro valor predeterminado.</para>
		<important>
			<title>Importante</title>
			<para>La configuración del bypass de IPS se realiza a nivel de software. Para determinar la configuración de los bypass a nivel de hardware, consultar el apartado <literal>Segments</literal>.</para>			
		</important>
		<para><literal>Segments</literal></para>
		<para>En este apartado se muestra la configuración de los segmentos y si estos disponen, o no, de bypass por hardware. Esta información es configurada durante el proceso de instalación y registro de los sensores en el Manager.<footnote><para>Ver capítulo 2 "Instalación y registro de los sensores IPS/IDS".</para></footnote></para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch06_img007.png"/>
			</imageobject>
			<caption>
				<para>Segmentos de sensor IPS/IDS</para>
			</caption>
		</mediaobject>
		<para><literal>Groups</literal></para>
		<para>Es posible crear grupos de segmentos y bindings con el fin de aplicar diferentes políticas a diferentes niveles de un mismo sensor: sensor, grupo o binding.
		Esta funcionalidad permite que con una sola máquina el usuario pueda crear numerosos entornos a los que aplicar distintas políticas según sus necesidades.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch06_img008.png"/>
			</imageobject>	
			<caption>
				<para>Grupo de sensores</para>
			</caption>
		</mediaobject>
		<section>
			<title>Activar Send Retry</title>
			<para>En algunas ocasiones el anillo de Snort puede estar lleno y, por tanto, el envío de los paquetes queda pausado. Para evitar esta situación, es posible programar el número de veces que se debe reintentar el envío (máximo 1000 reintentos). El tiempo de espera establecido por defecto para proceder al reintento es de 1 microsegundo.</para>
			<para>Al tratarse de una necesidad especial, esta configuración ha de realizarse directamente en el sensor, para lo que el usuario deberá modificar los archivos de texto asociados al sensor. Los parámetros incluidos en este archivo de texto, una vez ha sido registrado el sensor, no se pueden modificar desde la web; es necesario realizar los cambios desde la terminal.</para>
			<para>El archivo que se debe modificar es el siguiente: <literal>/opt/rb/etc/sysconfig/snort-[id. grupo]</literal>.</para>
			<para>Este archivo muestra información relacionada con la configuración del sensor: lista de CPUs, interfaces del grupo, valores para PF_RING o el modo configurado para el sensor.</para>
			<screen>    [root@rbsensor ~]# vim /opt/rb/etc/sysconfig/snort-0
				################################################################################
				## Generated by Chef for rbsensor
				################################################################################
				DAEMON_COREFILE_LIMIT='unlimited'
				INTERFACES="bpbr0,bpbr1"
				CPU_LIST="0,1,2,3,4,5,6,7"
				CONF="/opt/rb/etc/snort/0/snort.conf"
				INSTANCES_GROUP="0"
				INSTANCES_GROUP_NAME="default"
				USER="snort"	
				GROUP="snort"
				LOGDIR="/var/log/snort/0"
				SYSLOG="/var/log/messages"
				NO_PACKET_LOG=0
				PRINT_INTERFACE=0
				SECS=5
				PFRING_CLUSTERMODE=2
				PFRING_WATERMARK=16
				AUTOBYPASS=0
				FORCE_ALERT=1
				SNORT_MODE="IDS_FWD"
				INLINE=0
				INLINE_TEST=0
				IDS_SPAN=0
				PFRING_BESTEFFORT=0
				PFRING_BESTEFFORT_MINNUMSLOTS=8192
				# disabled
				PFRING_SBYPASS=0
				PFRING_SBYPASS_UPPERTHRESHOLD=
				PFRING_SBYPASS_LOWERTHRESHOLD=
				PFRING_SBYPASS_SAMPLINGRATE=
			</screen>
			<warning>
				<title>Advertencia</title>
				<para>Los parámetros de la web son actualizados cada cierto tiempo, por lo que es posible que la configuración realizada desde la terminal sea sobrescrita. Una manera de solventar este problema es crear una copia local del fichero:</para>
				<para><literal>/opt/rb/etc/sysconfig/snort-[id. grupo]_local</literal></para>
				<para>Snort está configurado para leer en local si existe el archivo <literal>*_local</literal>. Los parámetros que pertenezcan a este archivo de texto ya no se podrán modificar desde la web (PF_RING clustermode, PF_RING watermark, etc.), sino que deberán modificarse siempre desde la terminal.</para>	
			</warning>			
		</section>	
	</section>	
	<section>
		<title>Servidores</title>
		<para>En este apartado el usuario puede definir la configuración de los servidores Proxy y Syslog.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch06_img009.png"/>
			</imageobject>
			<caption>
				<para>Configuración servidores Proxy y Syslog</para>
			</caption>
		</mediaobject>
		<para>Este apartado mostrará todos sus campos con la configuración heredadas por el sensor. El usuario podrá editar la siguiente información: </para>
		<itemizedlist mark="bullet">
			<listitem>
				<para>Syslog Servers</para>
			</listitem>
			<listitem>
				<para>Syslog protocol: UDP/TCP</para>
			</listitem>
			<listitem>
				<para>Syslog mode: Basic/Extended</para>
			</listitem>
			<listitem>						
				<para>Enable proxy: Yes/No</para>
			</listitem>
		</itemizedlist>
	</section>
	<section>
		<title>Trap Servers</title>
		<para>En este apartado se realiza la configuración del SNMP de los <literal>Trap Servers</literal>.</para> 
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch06_img010.png"/>
			</imageobject>
			<caption>
				<para>Listado de Trap Servers</para>
			</caption>
		</mediaobject>
		<para><emphasis role="bold">Añadir Trap Server</emphasis>: es posible añadir un nuevo <literal>Trap Server</literal> haciendo clic en <literal>+Add</literal>. A continuación, introducir la IP y la Comunidad SNMP a la que pertenece. <literal>Update</literal> para guardar los cambios introducidos.</para>		
		<para><emphasis role="bold">Eliminar Trap Server</emphasis>: pulsar en el icono de eliminación para descartar el Trap Server.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="350" fileref="images/ch06_img011.png"/>
			</imageobject>
			<caption>
				<para>Añadir nuevo Trap Server</para>
			</caption>
		</mediaobject>
	</section>
	<section>
		<title>Segmentos</title>
		<para>En este apartado se muestra un listado con los segmentos de inspección que se han creado durante el proceso de configuración del sensor. Por estos segmentos pasa el tráfico que redBorder IPS debe analizar. En el apartado "Grupos" se explica cómo se puede editar el sensor para que, por cada segmento, se analice el tráfico en función de distintas políticas de seguridad.</para>
		<para>En el listado de segmentos aparece la siguiente información:</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para><emphasis role="bold">Segment</emphasis>: nombre del segmento.</para>
			</listitem>
			<listitem>
				<para><emphasis role="bold">Interfaces</emphasis>: interfaces de red que conforman el segmento.</para>
			</listitem>
			<listitem>
				<para><emphasis role="bold">Bypass</emphasis>: casilla de activación o desactivación del bypass por hardware.</para>
			</listitem>
			<listitem>
				<para><emphasis role="bold">Type</emphasis>: tipo de segmento (fibra o cobre).</para>
			</listitem>
			<listitem>
				<para><emphasis role="bold">Speed</emphasis>: velocidad en bits por segundo.</para>
			</listitem>
		</itemizedlist> 
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/informacion_sobre_los_segmentos_de_red_del_sensor.png"/>
			</imageobject>
			<caption>
				<para>Información sobre los segmentos de red del sensor</para>
			</caption>
		</mediaobject>
	</section>
	<section>
		<title>Network routes</title>
		<para>Permite la configuración de rutas adicionales que complementan a la pasarela predeterminada.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="350" fileref="images/ch06_img013.png"/>
			</imageobject>
			<caption>
				<para>Rutas estáticas de red o Network Routes</para>
			</caption>
		</mediaobject>
		<para> Es posible añadir una nueva ruta mediante la pestaña <literal>+Add Route.</literal> A continuación insertar red y pasarela de red.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch06_img014.png"/>
			</imageobject>
			<caption>
				<para>Añadir nueva ruta de red: <literal>Network Route</literal></para>
			</caption>
		</mediaobject>
	</section>
	<section>
		<title>Location</title>
		<para>Localiza el sensor o el dominio en un mapamundi.</para>
		<para><emphasis role="bold">Añadir localización</emphasis>: es posible agregar una localización desde la opción <literal>+Add Location</literal> e introducir las coordenadas, o bien, mediante el menú desplegado por el botón derecho del ratón.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="350" fileref="images/ch06_img015.png"/>
			</imageobject>
			<caption>
				<para>Añadir localización del sensor: +Add Location</para>
			</caption>
		</mediaobject>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch06_img015b.png"/>
			</imageobject>
			<caption>
				<para>Añadir localización del sensor: menú botón derecho</para>
			</caption>
		</mediaobject>
		<warning>
			<title>Advertencia</title>
			<para>Para poder visualizar datos en la vista <literal>Maps</literal> es necesario añadir las localizaciones de los sensores en esta interfaz.</para>
		</warning>
	</section>
	<section>
		<title>IP Variables</title> 
		<para>En este apartado se muestran los valores de la configuración de Snort para las variables de tipo IP.</para>
		<para>Algunas variables de Snort deben ser modificadas (editadas) para adaptarlas a la infraestructura de red del usuario y que, de este modo, Snort pueda reconocerlas. Por ejemplo, en el caso de que se hayan configurado redes locales con IPs públicas. </para>
		<para>Aquellas variables IP heredadas de un nivel superior aparecerán con un check en la casilla <literal>Inherited</literal>.</para>
		<para><emphasis role="bold">Acciones disponibles</emphasis>: exportar, importar, editar y eliminar las variables IP. </para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="350" fileref="images/ch06_img016.png"/>
			</imageobject>
			<caption>
				<para>Variables IP</para>
			</caption>
		</mediaobject>
		<note>
			<title>Nota</title>
			<para>Para obtener más información acerca de los valores de las variables IP se recomienda consultar el manual de usuario de Snort.</para>
		</note>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch06_img017.png"/>
			</imageobject>
			<caption>
				<para>Editar valores de las Variables IP</para>
			</caption>
		</mediaobject>
		<para>Es posible exportar e importar variables IP desde las pestañas <literal>Export</literal> e <literal>Import</literal>. El formato de archivo usado en la importación y exportación debe ser CSV.</para>
		<para>La opción de importación de variables ofrece la posibilidad de añadir variables o reemplazar las existentes.</para>
		<warning>
			<title>Advertencia</title>
			<para>En caso de seleccionar la opción <literal>Replace variables</literal> al importar variables, las nuevas variables anularán los valores que se muestran en la lista en caso de que la variable ya existiera y, ésta, no fuera heredada.</para>
		</warning>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="350" fileref="images/ch06_img018.png"/>
			</imageobject>
			<caption>
				<para>Importar variables IP</para>
			</caption>
		</mediaobject>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="350" fileref="images/ch06_img018b.png"/>
			</imageobject>
			<caption>
				<para>Exportar variables IP</para>
			</caption>
		</mediaobject>
	</section>
	<section>
		<title>Port Variables</title>
		<para>En este apartado se muestran los valores de la configuración de Snort para las variables de tipo puerto.</para>
		<para>Los valores de estas variables también pueden ser editadas en casos excepcionales en los que se hayan definido puertos no convencionales. De este modo, Snort podrá reconocer dichas variables. Aquellas que sean heredadas de un nivel superior tendrán activada la casilla <literal>Inherited</literal>.</para>
		<para><emphasis role="bold">Acciones disponibles</emphasis>: exportar, importar, editar y eliminar las variables de puertos. </para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch06_img019.png"/>
			</imageobject>
			<caption>
				<para>Variables puerto</para>
			</caption>
		</mediaobject>
		<note>
			<title>Nota</title>
			<para>Para obtener más información acerca de los valores de las variables puerto se recomienda consultar el manual de usuario de Snort.</para>
		</note>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="350" fileref="images/ch06_img020.png"/>
			</imageobject>
			<caption>
				<para>Editar valores de las variables de tipo puerto</para>
			</caption>
		</mediaobject>
		<para>Es posible exportar e importar variables de puertos desde las pestañas <literal>Export</literal> e <literal>Import</literal>. El formato de archivo usado en la importación y exportación debe ser CSV.</para>
		<para>La opción de importación de variables ofrece la posibilidad de añadir variables o reemplazar las existentes.</para>
		<warning>
			<title>Advertencia</title>
			<para>En caso de seleccionar la opción <literal>Replace variables</literal> al importar variables, las nuevas variables anularán los valores que se muestran en la lista en caso de que la variable ya existiera y, ésta, no fuera heredada.</para>
		</warning>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="350" fileref="images/ch06_img021.png"/>
			</imageobject>
			<caption>
				<para>Importar variables de tipo puerto</para>
			</caption>
		</mediaobject>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="350" fileref="images/ch06_img021b.png"/>
			</imageobject>
			<caption>
				<para>Exportar variables de tipo puerto</para>
			</caption>
		</mediaobject>
	</section>
	<section>
		<title><literal>Groups</literal></title>

		<para>Tal y como se adelantó en el apartado “Segmentos”, en un sensor redBorder IPS es posible analizar el tráfico que pasa por cada <emphasis role="bold">segmento</emphasis> empleando, en cada uno de ellos, distintas <emphasis role="bold">políticas de seguridad</emphasis>. Esto se consigue gracias a los <emphasis role="bold">grupos de segmentos</emphasis>.</para>

		<para>Los grupos están formados por los segmentos del sensor, y sobre estos grupos pueden aplicarse las siguientes configuraciones específicas para el grupo, que sobrescriben a las configuraciones genéricas del sensor:</para>

		<itemizedlist mark="bullet">
			<listitem>
				<para>Políticas de firmas y de reputación</para>
			</listitem>
			<listitem>
				<para>Modo de operación del sensor</para>
			</listitem>
			<listitem>
				<para>IPS/IDS Settings</para>
			</listitem>
			<listitem>
				<para>IP Variables</para>
			</listitem>
			<listitem>
				<para>Port Variables</para>
			</listitem>
		</itemizedlist>

		<section>
			<title>Premisas para la creación de grupos de segmentos</title>

			<para>Para la creación de grupos de segmentos en un sensor redBorder IPS es importante tener en cuenta las siguientes premisas:</para>

			<itemizedlist mark="bullet">
				<listitem>
					<para>Pueden crearse tantos grupos como segmentos tenga el sensor.</para>
				</listitem>
				<listitem>
					<para>Un grupo puede estar formado por uno o varios segmentos, y no necesariamente solo por uno.</para>
				</listitem>
				<listitem>
					<para>No es posible que un segmento pertenezca a más de un grupo.</para>
				</listitem>
				<listitem>
					<para>Si ningún segmento ha sido asignado a un grupo en concreto, este grupo queda deshabilitado.</para>
				</listitem>
				<listitem>
					<para>Del conjunto de CPUs del que dispone el sensor, es posible especificar cuáles serán utilizados en cada grupo, pudiendo incluso asignar un mismo procesador a distintos grupos.</para>
				</listitem>
			</itemizedlist>

			<para>Por ejemplo, para un sensor con 4 segmentos de red y 4 CPUs podríamos establecer una configuración de grupos como la de la imagen de abajo, en la que se han creado 4 grupos:</para>

			<itemizedlist mark="bullet">
				<listitem>
					<para>group01: Inspecciona 2 segmentos (br0 y br1) y utiliza las 4 CPUs (0, 1, 2 y 3) para ello.</para>
				</listitem>
				<listitem>
					<para>group02: Inspecciona 1 segmento (br3) y utiliza 1 CPU (0) para ello.</para>
				</listitem>
				<listitem>
					<para>group03: Inspecciona 1 segmento (br2) y utiliza 2 CPUs (2 y 3) para ello.</para>
				</listitem>
				<listitem>
					<para>group04: Queda deshabilitado al no tener seleccionado ningún segmento ni ninguna CPU.</para>
				</listitem>
			</itemizedlist>

			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ejemplo_de_configuracion_de_grupos_en_redBorder_IPS.png"/>
				</imageobject>
				<caption>
					<para>Ejemplo de configuración de grupos en redBorder IPS</para>
				</caption>
			</mediaobject>

			<para>El sensor redBorder IPS levanta tantas instancias de Snort como casillas de CPU estén marcadas, por lo que, en un escenario como el de este ejemplo habría 7 instancias de Snort corriendo.</para>

		</section>

		<section>
			<title>Gestión de grupos de segmentos</title>

			<para>En esta sección se explica cómo gestionar los grupos de segmentos del sensor redBorder IPS. Para ello, se toma como ejemplo un sensor con 4 segmentos de red y 4 CPUs.</para>

			<section>
				<title>Situación inicial y configuración mínima necesaria</title>

				<para>Una vez registrado el sensor IPS en redBorder Manager, la configuración por defecto de los grupos dentro de las opciones de edición del sensor es la siguiente:</para>

				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/configuracion_por_defecto_de_grupos_para_un_sensor_con_4_segmentos_y_4_CPUs.png"/>
					</imageobject>
					<caption>
						<para>Configuración por defecto de grupos para un sensor con 4 segmentos y 4 CPUs</para>
					</caption>
				</mediaobject>

				<para>Como se puede observar, el sensor cuenta con un grupo creado por defecto que hereda el modo de operación del propio sensor (ver columna <literal>Sensor mode</literal>). Este grupo no tiene ningún segmento seleccionado por defecto, pero sí tiene todas las CPUs asignadas.</para>

				<para>Al no tener ningún segmento seleccionado <emphasis role="bold">el grupo está deshabilitado, por lo que no es posible aplicar ninguna política de seguridad</emphasis> en el mismo. Esto significa que, en el caso de no querer realizar una configuración personalizada de los grupos de segmentos, <emphasis role="bold">al menos hay que realizar una configuración mínima necesaria</emphasis>, que consiste en indicar qué segmentos deben incluirse en el grupo por defecto, para así poder aplicar las políticas de seguridad deseadas.</para>

				<para>Para habilitar el grupo es necesario marcar como mínimo un segmento y asegurarse de que al menos esté asignada una CPU. Para el sensor IPS con 4 segmentos y 4 CPUs de la imagen anterior, sería suficiente con seleccionar un segmento del que se quisiera analizar el tráfico que pasa por él, como por ejemplo el segmento <literal>br0</literal> y, a continuación, hacer clic en el botón <literal>Update</literal>. Este proceso se muestra en la imagen de abajo.</para>

				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/seleccion_de_segmento_br0_para_grupo_por_defecto.png"/>
					</imageobject>
					<caption>
						<para>Selección de segmento <literal>br0</literal> para grupo por defecto</para>
					</caption>
				</mediaobject>

				<warning>
					<title>Configuración inicial y necesaria de grupos de segmentos</title>
					<para>Después de realizar el registro del sensor IPS contra el Manager de redBorder es <emphasis role="bold">necesario realizar la configuración de los grupos antes de aplicar políticas de seguridad</emphasis> en el sensor.</para>
				</warning>

			</section>

			<section>
				<title>Creación de grupos de segmentos</title>

				<para>En el caso de querer añadir más grupos de segmentos en el sensor, basta con hacer clic en <literal>+Add Group</literal>. Aparecerá una ventana emergente en la que habrá que incluir el nombre del grupo, como se muestra en la siguiente imagen.</para>

				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/creacion_de_nuevo_grupo_de_segmentos_internal_network.png"/>
					</imageobject>
					<caption>
						<para>Creación de nuevo grupo de segmentos: Internal Network</para>
					</caption>
				</mediaobject>

				<para>Una vez añadido el nuevo grupo, éste se sitúa en la lista de grupos, sin tener ningún segmento ni CPU asignado, como se muestra en la siguiente imagen.</para>

				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/nuevo_grupo_de_segmentos_creado.png"/>
					</imageobject>
					<caption>
						<para>Nuevo grupo de segmentos creado</para>
					</caption>
				</mediaobject>

			</section>

			<section>
				<title>Configuración de grupos de segmentos</title>

				<para>Después de crear los grupos de segmentos necesarios, el usuario podrá realizar una primera configuración de los mismos desde esta misma interfaz:</para>

				<itemizedlist mark="bullet">
					<listitem>
						<para><literal>Name</literal>: editar el nombre del grupo de segmentos.</para>
					</listitem>
				</itemizedlist>

				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/configuracion_de_grupos_cambio_de_nombre.png"/>
					</imageobject>
					<caption>
						<para>Configuración de grupos: cambio de nombre</para>
					</caption>
				</mediaobject>

				<itemizedlist mark="bullet">
					<listitem>
						<para><literal>Sensor mode</literal>: selección del modo que se aplicará a nivel de grupo (se hereda por defecto el modo del sensor).</para>
					</listitem>
				</itemizedlist>

				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/configuracion_de_grupos_cambio_de_modo.png"/>
					</imageobject>
					<caption>
						<para>Configuración de grupos: cambio de modo</para>
					</caption>
				</mediaobject>

				<itemizedlist mark="bullet">
					<listitem>
						<para><literal>Segments</literal>: aparecen marcados los segmentos incluidos en el grupo.</para>
					</listitem>
					<listitem>
						<para><literal>CPUs</literal>: aparecen marcadas las CPUs asignadas al grupo de segmentos.</para>
					</listitem>
				</itemizedlist>

				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/configuracion_de_grupos_cambio_de_CPUs_asignadas.png"/>
					</imageobject>
					<caption>
						<para>Configuración de grupos: cambio de CPUs asignadas</para>
					</caption>
				</mediaobject>

				<important>
					<title>Asignación de CPUs y balanceo de carga</title>
					<para>Cuando existe más de un grupo de segmentos es recomendable que se le asignen CPUs diferentes a cada grupo para distribuir los procesos y, de este modo, balancear la carga de cada CPU.</para>			
				</important>

				<para>Una vez realizados estos ajustes iniciales, es posible acceder a la siguiente interfaz de configuración al hacer clic en el botón de edición de cada grupo.</para>

				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/configuracion_de_grupos_boton_de_edicion.png"/>
					</imageobject>
					<caption>
						<para>Configuración de grupos: botón de edición</para>
					</caption>
				</mediaobject>

				<variablelist>
					<varlistentry>
						<term>
							<literal>Name</literal>
						</term>
						<listitem>
							<para>Editar nombre del grupo.</para>
						</listitem>
					</varlistentry>
					<varlistentry>
						<term>
							<literal>Description</literal>
						</term>
						<listitem>
							<para>Añadir una descripción al grupo de segmentos.</para>
						</listitem>
					</varlistentry>
					<varlistentry>
						<term>
							<literal>IPS/IDS Settings</literal>
						</term>
						<listitem>
							<para>Configuración de los parámetros de Snort a nivel de grupo.</para>
						</listitem>
					</varlistentry>
					<varlistentry>
						<term>
							<literal>IP Variables</literal>
						</term>
						<listitem>
							<para>Listado de valores para las variables IP de Snort a nivel de grupo. Algunas variables de Snort deben ser modificadas (editadas) para adaptarlas a la infraestructura de red del usuario y que, de este modo, Snort pueda reconocerlas. Aquellas que sean heredadas de un nivel superior, aparecerán con un check en la casilla <literal>Inherited</literal>.</para>
						</listitem>
					</varlistentry>
					<varlistentry>
						<term>
							<literal>Port Variables</literal>
						</term>
						<listitem>
							<para>En este apartado se muestran los valores para las variables de los puertos Snort a nivel de grupo. Los valores de estas variables también pueden ser editados en casos excepcionales en los que se hayan definido puertos no convencionales. De este modo, Snort podrá reconocer dichas variables. Aquellas que sean heredadas de un nivel superior, aparecerán marcadas con un check en la casilla <literal>Inherited</literal>.</para>
						</listitem>
					</varlistentry>
					<varlistentry>
						<term>
							<literal>Bindings</literal>
						</term>
						<listitem>
							<para>Los bindings son particiones del tráfico a través de red o VLAN. Actúan como hijos del grupo a nivel de herencias y aplicación de políticas.</para>
						</listitem>
					</varlistentry>
				</variablelist>

				<note>
					<title>Herencia en grupos de segmentos</title>
					<para>Recuerde que el grupo de segmentos mostrará la configuración que ha heredado del sensor. Esta es la que se mostrará por defecto en la pantalla de edición a nivel de grupo.</para>
				</note>

				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/interfaz_de_configuracion_de_grupo_de_segmentos.png"/>
					</imageobject>
					<caption>
						<para>Interfaz de configuración de grupos de segmentos</para>
					</caption>
				</mediaobject>

			</section>

			<section>
				<title>Eliminación de grupos de segmentos</title>

				<para>En cualquier momento se puede borrar un grupo de segmento mediante el icono de eliminación. El sistema mostrará un mensaje de confirmación.</para>

				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/eliminacion_de_grupo_de_segmentos.png"/>
					</imageobject>
					<caption>
						<para>Eliminación de grupo de segmentos</para>
					</caption>
				</mediaobject>

				<important>
					<title>Grupos eliminados y políticas</title>
					<para>En caso de que un grupo tuviera asignada una serie de políticas, al eliminar el grupo, estas dejarán de aplicarse en los segmentos que pertenecían al grupo. Los segmentos quedarán libres para ser seleccionados en otro grupo.</para>			
				</important>

			</section>

		</section>

		<section>
			<title>Bindings</title>

			<para>Como se ha visto en apartados anteriores, un sensor IPS puede contar con distintos segmentos por los que transcurre tráfico de diferentes zonas de red. A su vez, gracias a los grupos, a cada segmento se le puede aplicar una configuración y política de seguridad específica. A partir de aquí es donde entra en juego el concepto de bindings.</para>

			<para>En redBorder IPS, <emphasis role="bold">un binding es una diferenciación del tráfico que transcurre por un segmento</emphasis>. Esta diferenciación puede hacerse en base a una VLAN o a una red. De esta forma, al crear un binding dentro de un grupo y asignarle un identificador VLAN, se consigue que el tráfico relativo a esa VLAN cuente con una configuración y políticas de seguridad distintas. Con esto se consigue granular aún más las configuraciones y políticas aplicadas en un sensor redBorder IPS.</para>

			<para>Sobre cada binding pueden aplicarse las siguientes configuraciones específicas para el grupo, que sobrescriben a las configuraciones genéricas del sensor:</para>

			<itemizedlist mark="bullet">
				<listitem>
					<para>Políticas de firmas (no de reputación)</para>
				</listitem>
				<listitem>
					<para>IPS/IDS Settings (sólo para los campos <literal>Threshold Count</literal> y <literal>Threshold Seconds)</literal></para>
				</listitem>
				<listitem>
					<para>IP Variables</para>
				</listitem>
				<listitem>
					<para>Port Variables</para>
				</listitem>
			</itemizedlist>

			<para>Dentro de cada grupo de segmentos siempre hay un binding creado por defecto que contiene la configuración que se aplica a todo el tráfico que pasa por los segmentos de su grupo, salvo el tráfico relativo a algún binding existente. De esta forma, el tráfico no relativo a las redes o VLANs incluidos en el resto de bindings pertenece al binding por defecto.</para>

			<section>
				<title>Premisas para la creación de bindings</title>

				<para>Para la creación de bindings en un grupo de segmentos es importante tener en cuenta las siguientes premisas:</para>

				<itemizedlist mark="bullet">
					<listitem>
						<para>Pueden crearse tantos bindings como se quiera.</para>
					</listitem>
					<listitem>
						<para>Un binding puede estar formado por uno o varios identificadores VLAN y por una o varias redes.</para>
					</listitem>
					<listitem>
						<para>Salvo el binding creado por defecto, si un binding no tiene ningún identificador VLAN ni ninguna red asociado, se considera que está deshabilitado.</para>
					</listitem>
					<listitem>
						<para>Si alguna red o VLAN se ha añadido en más de un binding, el tráfico de esa red o VLAN se asociará al binding que haya sido creado en primer lugar.</para>
					</listitem>
					<listitem>
						<para>Si una red menor está contenida en otra red mayor y ambas se han añadido a bindings distintos, al haber tráfico perteneciente a la red menor y a la red mayor, éste se asociará al binding que haya añadido a la red menor, independientemente del orden de creación del binding.</para>
					</listitem>
				</itemizedlist>

				<note>
					<title>Objetos de tipo VLAN y de tipo NET</title>
					<para>Los identificadores VLAN y redes deben estar declarados como objetos de tipo VLAN y NET, respectivamente, para que puedan ser incluidos en los bindings. Estos objetos se pueden declarar en la sección <literal>Tools -> Objects</literal> de redBorder Manager.</para>
				</note>

				<para>Por ejemplo, para un grupo de segmentos cualquiera, podríamos establecer una configuración de bindings como la de la imagen de abajo, en la que se han creado 3 bindings además del ya existente por defecto:</para>

				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ejemplo_de_configuracion_de_bindings_en_redBorder_IPS.png"/>
					</imageobject>
					<caption>
						<para>Ejemplo de configuración de bindings en redBorder IPS</para>
					</caption>
				</mediaobject>

			</section>

			<section>
				<title>Gestión de bindings</title>

				<para>En esta sección se explica cómo gestionar los bindings de un grupo de segmentos del sensor redBorder IPS. Para ello, se toma como ejemplo un grupo cualquiera.</para>

				<section>
					<title>Situación inicial</title>
					<para>Un grupo de segmentos cuenta, por defecto, con un único binding por el que pasa todo el tráfico. A este binding se le da el nombre “default” y no puede ser cambiado.</para>

					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="450" fileref="images/binding_por_defecto_de_un_grupo_de_segmentos_cualquiera.png"/>
						</imageobject>
						<caption>
							<para>Binding por defecto de un grupo de segmentos cualquiera</para>
						</caption>
					</mediaobject>

					<para>El binding “default” se encuentra habilitado por defecto, por lo que no es necesario realizar ninguna configuración adicional para que el tráfico que pase por este binding pueda ser analizado una vez que se aplique una política de seguridad al mismo.</para>

				</section>

				<section>
					<title>Creación de bindings</title>

					<para>En el caso de querer añadir más bindings al grupo de segmentos para poder aplicar una configuración más granular al tráfico que transcurra por este grupo, basta con hacer clic en <literal>+Add Binding</literal>. Aparecerá una ventana emergente en la que habrá que incluir el nombre del binding, como se muestra en la siguiente imagen.</para>

					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="450" fileref="images/creacion_de_nuevo_binding_lab_network.png"/>
						</imageobject>
						<caption>
							<para>Creación de nuevo binding: Lab network</para>
						</caption>
					</mediaobject>

					<warning>
						<title>Binding deshabilitado por defecto</title>
						<para>En la ventana emergente de la imagen anterior aparece un aviso indicando que el binding no estará habilitado hasta que no se le asocie una VLAN o red.</para>
					</warning>

					<para>Una vez añadido el nuevo binding, éste se sitúa en la lista de bindings, como se muestra en la siguiente imagen.</para>

					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="450" fileref="images/nuevo_binding_creado.png"/>
						</imageobject>
						<caption>
							<para>Nuevo binding creado</para>
						</caption>
					</mediaobject>

				</section>

				<section>
					<title>Configuración de bindings</title>

					<para>Después de crear los bindings necesarios, el usuario podrá acceder a la interfaz de configuración de los mismos al hacer clic en el botón de edición correspondiente.</para>

					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="450" fileref="images/configuracion_de_bindings_boton_de_edicion.png"/>
						</imageobject>
						<caption>
							<para>Configuración de bindings: botón de edición</para>
						</caption>
					</mediaobject>

					<para>En esta interfaz el usuario podrá modificar la siguiente información:</para>

					<variablelist>
						<varlistentry>
							<term>
								<literal>Name</literal>
							</term>
							<listitem>
								<para>Editar nombre del binding (inhabilitado para el binding “default”).</para>
							</listitem>
						</varlistentry>
						<varlistentry>
							<term>
								<literal>Description</literal>
							</term>
							<listitem>
								<para>Añadir una descripción al binding.</para>
							</listitem>
						</varlistentry>
						<varlistentry>
							<term>
								<literal>IPS/IDS Settings</literal>
							</term>
							<listitem>
								<para>Configuración de los parámetros de Snort a nivel de binding (sólo para los campos <literal>Threshold Count</literal> y <literal>Threshold Seconds</literal>).</para>
							</listitem>
						</varlistentry>
						<varlistentry>
							<term>
								<literal>IP Variables</literal>
							</term>
							<listitem>
								<para>Listado de valores para las variables IP de Snort a nivel de binding. Algunas variables de Snort deben ser modificadas (editadas) para adaptarlas a la infraestructura de red del usuario y que, de este modo, Snort pueda reconocerlas. Aquellas que sean heredadas de un nivel superior, aparecerán con un check en la casilla <literal>Inherited</literal>.</para>
							</listitem>
						</varlistentry>
						<varlistentry>
							<term>
								<literal>Port Variables</literal>
							</term>
							<listitem>
								<para>En este apartado se muestran los valores para las variables de los puertos Snort a nivel de binding. Los valores de estas variables también pueden ser editados en casos excepcionales en los que se hayan definido puertos no convencionales. De este modo, Snort podrá reconocer dichas variables. Aquellas que sean heredadas de un nivel superior, aparecerán marcadas con un check en la casilla <literal>Inherited</literal>.</para>
							</listitem>
						</varlistentry>
						<varlistentry>
							<term>
								<literal>VLANs</literal>
							</term>
							<listitem>
								<para>En este apartado se configuran las VLANs asociadas al binding (no disponible para el binding “default”).</para>
							</listitem>
						</varlistentry>
						<varlistentry>
							<term>
								<literal>Networks</literal>
							</term>
							<listitem>
								<para>En este apartado se configuran las redes asociadas al binding (no disponible para el binding “default”).</para>
							</listitem>
						</varlistentry>
					</variablelist>

					<note>
						<title>Herencia en bindings</title>
						<para>Recuerde que el binding mostrará la configuración que ha heredado del grupo de segmentos. Esta es la que se mostrará por defecto en la pantalla de edición a nivel de binding.</para>
					</note>

					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="450" fileref="images/interfaz_de_configuracion_de_bindings.png"/>
						</imageobject>
						<caption>
							<para>Interfaz de configuración de bindings</para>
						</caption>
					</mediaobject>

				</section>

				<section>
					<title>Eliminación de bindings</title>

					<para>Salvo el binding “default”, es posible eliminar el resto de bindings creados mediante el icono de eliminación. El sistema mostrará un mensaje de confirmación.</para>

					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="450" fileref="images/eliminacion_de_binding.png"/>
						</imageobject>
						<caption>
							<para>Eliminación de binding</para>
						</caption>
					</mediaobject>

					<important>
						<title>Bindings eliminados y políticas</title>
						<para>En caso de que un binding tuviera asignada una serie de políticas, al eliminar el binding, estas dejarán de aplicarse en las VLANs y/o redes definidas en el binding, y el tráfico que pase por éstas se analizará según la configuración y las políticas del binding por defecto.</para>
					</important>

				</section>
			</section>
		</section>

		<section>
			<title>Consideraciones de jerarquía para grupos de segmentos y bindings</title>

			<para>En cuanto a la jerarquía establecida entre los sensores redBorder IPS, sus grupos de segmentos y los bindings de cada grupo de segmento, por defecto, cada binding cuelga del grupo donde haya sido creado, de la misma forma que cada grupo cuelga del sensor donde haya sido creado.</para>

			<para>En la imagen de abajo se muestra un ejemplo de cómo sería esta estructura jerárquica creada por defecto.</para>
<!--
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/estructura_jerarquica_creada_por_defecto_para_sensores_grupos_y_bindings.png"/>
				</imageobject>
				<caption>
					<para>Estructura jerárquica creada por defecto para sensores, grupos y bindings</para>
				</caption>
			</mediaobject>
-->
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/estructura_jerarquica_creada_por_defecto_para_sensores_grupos_y_bindings.png"/>
				</imageobject>
				<caption>
					<para>Test 1:</para>
				</caption>
			</mediaobject>

			<mediaobject>
				<imageobject>
					<imagedata align="center" fileref="images/estructura_jerarquica_creada_por_defecto_para_sensores_grupos_y_bindings.png"/>
				</imageobject>
				<caption>
					<para>Test 2: align="center"</para>
				</caption>
			</mediaobject>

			<mediaobject>
				<imageobject>
					<imagedata width="240" fileref="images/estructura_jerarquica_creada_por_defecto_para_sensores_grupos_y_bindings.png"/>
				</imageobject>
				<caption>
					<para>Test 3: width="240"</para>
				</caption>
			</mediaobject>

			<mediaobject>
				<imageobject>
					<imagedata align="center" width="240" fileref="images/estructura_jerarquica_creada_por_defecto_para_sensores_grupos_y_bindings.png"/>
				</imageobject>
				<caption>
					<para>Test 4: align="center" width="240"</para>
				</caption>
			</mediaobject>

			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" width="240" fileref="images/estructura_jerarquica_creada_por_defecto_para_sensores_grupos_y_bindings.png"/>
				</imageobject>
				<caption>
					<para>Test 5: scalefit="1" width="240"</para>
				</caption>
			</mediaobject>

			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="240" fileref="images/estructura_jerarquica_creada_por_defecto_para_sensores_grupos_y_bindings.png"/>
				</imageobject>
				<caption>
					<para>Test 6: scalefit="1" align="center" width="240"</para>
				</caption>
			</mediaobject>

			<para>En este ejemplo hay dos sensores redBorder IPS (<literal>ips01</literal> e <literal>ips02</literal>). Ambos cuentan dos grupos de segmentos (<literal>group01</literal> y <literal>group02</literal> para <literal>ips01</literal> y <literal>DMZ</literal> e <literal>Internal Network</literal> para <literal>ips02</literal>). El primer grupo de cada sensor tiene un binding además del binding por defecto, y el segundo grupo solo tiene el binding por defecto. Debajo aparece también una pequeña estructura de dominios.</para>

			<para>Es posible modificar la estructura jerárquica creada por defecto siguiendo las dos siguientes premisas:</para>

			<itemizedlist mark="bullet">
				<listitem>
					<para>Un grupo de segmentos sólo puede colgar del sensor redBorder IPS que lo haya creado o de dominios (incluido <literal>root</literal>).</para>
				</listitem>
				<listitem>
					<para>Un binding sólo puede colgar del grupo que lo haya creado o de dominios (incluido <literal>root</literal>).</para>
				</listitem>
				<listitem>
					<para>Salvo el binding creado por defecto, si un binding no tiene ningún identificador VLAN ni ninguna red asociado, se considera que está deshabilitado.</para>
				</listitem>
			</itemizedlist>

			<para>En la imagen de abajo se muestra un ejemplo de cómo se podría modificar la estructura jerárquica creada por defecto.</para>

			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/estructura_jerarquica_modificada_de_sensores_grupos_y_bindings.png"/>
				</imageobject>
				<caption>
					<para>Estructura jerárquica modificada de sensores, grupos y bindings</para>
				</caption>
			</mediaobject>

			<para>En este ejemplo se han hecho los siguientes cambios:</para>

			<itemizedlist mark="bullet">
				<listitem>
					<para>Grupo <literal>group01</literal> del sensor <literal>ips01</literal> movido al dominio <literal>Domain 1</literal>.</para>
				</listitem>
				<listitem>
					<para>Binding <literal>g01-binding01</literal> del grupo <literal>group01</literal> del sensor <literal>ips01</literal> movido al dominio <literal>Sub-domain</literal>.</para>
				</listitem>
				<listitem>
					<para>Grupo <literal>DMZ</literal> del sensor <literal>ips02</literal> movido al dominio <literal>Sub-domain</literal>.</para>
				</listitem>
				<listitem>
					<para>Binding <literal>Lab network</literal> del grupo <literal>DMZ</literal> del sensor <literal>ips02</literal> movido al dominio <literal>Domain 2</literal>.</para>
				</listitem>
			</itemizedlist>

			<para>Estos movimientos son permitidos para poder aprovechar los beneficios de contar con una estructura jerárquica, como pueden ser la gestión de usuarios o la aplicación de políticas jerarquizada.</para>

			<para>Estos cambios pueden ser deshechos moviendo en la jerarquía cada grupo o binding dentro de los sensores o grupos que los crearon.</para>

		</section>
	</section>
</chapter>
